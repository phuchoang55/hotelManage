<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/admin-layout}">
<head>
    <title>Quản lý Blog</title>
</head>
<body>
<div layout:fragment="content">
    <h1>Quản lý Blog</h1>
    <form th:action="${blog != null} ? @{/admin/blogs/{id}(id=${blog.id})} : @{/admin/blogs}"
          method="post"
          enctype="multipart/form-data"
          class="form">

        <div class="mb-3">
            <label class="form-label">Tiêu đề</label>
            <input type="text"
                   class="form-control"
                   name="title"
                   th:value="${blog != null ? blog.title : ''}"
                   required />
        </div>

        <div class="mb-3">
            <label class="form-label">Mô tả ngắn (Excerpt)</label>
            <textarea class="form-control"
                      name="excerpt"
                      rows="3"
                      style="resize:vertical;"
                      th:text="${blog != null ? blog.excerpt : ''}"></textarea>
        </div>

        <div class="mb-3">
            <label class="form-label">Ảnh</label>
            <input type="file"
                   class="form-control"
                   name="image"
                   accept="image/*" />

            <div th:if="${blog != null && blog.imageUrl != null}"
                 style="margin-top:10px;padding:10px;border:1px solid #ddd;border-radius:4px;">
                <img th:src="${blog.imageUrl}"
                     alt="Current image"
                     style="max-width:200px;max-height:150px" />
            </div>
        </div>

        <div class="mb-3">
            <label class="form-label">Nội dung</label>
            <textarea class="form-control"
                      name="content"
                      id="editor"
                      rows="10"
                      th:text="${blog != null ? blog.content : ''}"></textarea>
        </div>

        <div class="d-flex gap-2">
            <a class="btn btn-secondary" th:href="@{/admin/blogs}">Hủy</a>
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i>
                <span th:text="${blog != null ? 'Cập nhật' : 'Thêm mới'}"></span>
            </button>
        </div>
    </form>
</div>

<th:block layout:fragment="extra-js">
    <script src="https://cdn.ckeditor.com/ckeditor5/36.0.1/classic/ckeditor.js"></script>
    <script>
        ClassicEditor
            .create(document.querySelector('#editor'))
            .catch(error => console.error(error));
    </script>
</th:block>
</body>
</html>
